---
description: æ€»ç»“C++æ ‡å‡†IOåº“çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•ã€‚
---

# IO

C++æ ‡å‡†åº“æä¾›çš„IOæ“ä½œæ¶‰åŠåˆ°çš„å¤´æ–‡ä»¶æœ‰ï¼š`<ios>`ã€`<istream>`ã€`<ostream>`ã€`<streambuf>`ã€`<iostream>`ã€`<fstream>`ã€`<sstream>`ã€‚

## âœ ç±»ç»“æ„

C++æ ‡å‡†åº“ä¸­ä¸€å…±æœ‰ä¸‰ç§IOç±»ï¼Œæ ‡å‡†è¾“å…¥è¾“å‡º\(`iostream`\)ï¼Œæ–‡ä»¶è¾“å…¥è¾“å‡º\(`fstream`\)ï¼Œå­—ç¬¦ä¸²è¾“å…¥è¾“å‡º\(`sstream`\)ï¼Œå…·ä½“ç±»å‹å¦‚ä¸‹å›¾ï¼Œå…¶ä¸­ä»¥`w`å¼€å¤´çš„ç±»å‹æ˜¯å®½å­—ç¬¦ç‰ˆæœ¬ï¼Œ`sstream`å’Œ`fstream`ç»§æ‰¿è‡ª`iostream`ï¼Œæ‰€ä»¥è¿™äº›ç±»å‹ä¹‹é—´æœ‰ç€å…±åŒçš„ç‰¹æ€§ã€‚

![](../../.gitbook/assets/50.gif)

* `ios_base`ï¼šè¡¨ç¤ºæµçš„åŸºæœ¬ç‰¹å¾ï¼›
* `ios`ï¼šç»§æ‰¿äº`ios_base`ï¼Œæä¾›äº†ä¸€ä¸ªæŒ‡å‘`streambuf`çš„æŒ‡é’ˆï¼›
* `streambuf`ï¼šä¸ºç¼“å†²åŒºæä¾›äº†å†…å­˜ï¼Œå¹¶æä¾›äº†ç”¨äºæ“ä½œç¼“å†²åŒºçš„æ–¹æ³•; 
* `istream/wistream`ï¼šç»§æ‰¿äº`ios`ç±»ï¼Œæä¾›äº†è¾“å…¥æ–¹æ³•ï¼›
* `ostream/wostream`ï¼šç»§æ‰¿äº`ios`ç±»ï¼Œæä¾›äº†è¾“å‡ºæ–¹æ³•ï¼›
* `iostream/wiostream`ï¼šç»§æ‰¿äº`istream`å’Œ`ostream`ï¼Œæä¾›äº†è¾“å…¥è¾“å‡ºæ–¹æ³•ï¼›
* `ifstream/wifstream`ï¼šç»§æ‰¿äº`istream`ï¼Œæä¾›äº†å¯¹æ–‡ä»¶è¿›è¡Œè¾“å…¥çš„æ–¹æ³•ï¼›
* `ofstream/wofstream`ï¼šç»§æ‰¿äº`ostream`ï¼Œæä¾›äº†å¯¹æ–‡ä»¶è¿›è¡Œè¾“å‡ºçš„æ–¹æ³•ï¼›
* `fstream/wfstream`ï¼šç»§æ‰¿äº`iostream`ï¼Œæä¾›äº†å¯¹æ–‡ä»¶è¿›è¡Œè¾“å…¥è¾“å‡ºçš„æ–¹æ³•ï¼›
* `istringstream/wistringstream`ï¼šç»§æ‰¿äº`istream`ï¼Œå¯¹å­—ç¬¦ä¸²è¿›è¡Œæ“ä½œçš„è¾“å…¥æµç±»ï¼›
* `ostringstream/wostringstream`ï¼šç»§æ‰¿äº`ostream`ï¼Œå¯¹å­—ç¬¦ä¸²è¿›è¡Œæ“ä½œçš„è¾“å‡ºæµç±»ï¼›
* `stringstream/wstringstream`ï¼šç»§æ‰¿äº`iostream`ï¼Œå¯¹å­—ç¬¦ä¸²è¿›è¡Œæ“ä½œçš„è¾“å…¥è¾“å‡ºæµç±»ã€‚

## âœ æ ‡å‡†IO

### ğŸ–‹ 1ã€å¸¸è§IOå¯¹è±¡

C++ä¸­æ ‡å‡†åº“æä¾›äº†å››ä¸ªæ ‡å‡†IOå¯¹è±¡:

1. `cin`ï¼šæ ‡å‡†è¾“å…¥æµå¯¹è±¡,é»˜è®¤æƒ…å†µä¸‹å…³è”åˆ°æ ‡å‡†è¾“å…¥è®¾å¤‡\(é”®ç›˜\)ã€‚ 
2. `cout`ï¼šæ ‡å‡†è¾“å‡ºæµå¯¹è±¡ï¼Œé»˜è®¤æƒ…å†µä¸‹å…³è”åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡\(æ˜¾ç¤ºå™¨\)ã€‚ 
3. `clog`ï¼šè¡¨ç¤ºé”™è¯¯çš„æ ‡å‡†è¾“å‡ºæµå¯¹è±¡ï¼Œé»˜è®¤æƒ…å†µä¸‹å…³è”åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡\(æ˜¾ç¤ºå™¨\)ã€‚ 
4. `cerr`ï¼šç”¨äºæ—¥å¿—è®°å½•çš„æ ‡å‡†è¾“å‡ºæµå¯¹è±¡ï¼Œé»˜è®¤æƒ…å†µä¸‹å…³è”åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡\(æ˜¾ç¤ºå™¨\)ã€‚è¯¥æµæœªè¢«ç¼“å†²ï¼Œè¿™æ„å‘³è¿™ä¿¡æ¯å°†ç›´æ¥å‘é€ç»™å±å¹•ï¼Œè€Œä¸æ˜¯ç­‰åˆ°ç¼“å†²åŒºä¸­å¡«æ»¡æ•°æ®æˆ–æœ‰æ–°çš„æ¢è¡Œç¬¦æ‰ä¼šå‘é€ã€‚ 

> å®é™…ä¸Šåº”æœ‰8ä¸ªå¯¹è±¡ï¼Œé’ˆå¯¹å®½å­—ç¬¦`wchar_t`ï¼Œä»¥ä¸Š4ä¸ªå¯¹è±¡éƒ½æœ‰å¯¹åº”çš„å¤„ç†`wchar_t`çš„å¯¹è±¡ã€‚

#### ğŸ–Œ 1.1ã€IOå¯¹è±¡æ— æ‹·è´æˆ–èµ‹å€¼

æµå¯¹è±¡ä¸èƒ½å­˜å‚¨åœ¨vectoræˆ–å…¶ä»–å®¹å™¨ä¸­ã€‚å½¢å‚æˆ–è¿”å›ç±»å‹ä¹Ÿä¸èƒ½ä¸ºæµç±»å‹ï¼Œå¦‚æœéœ€è¦ï¼Œåˆ™å¿…é¡»ä¼ é€’æˆ–è¿”å›æŒ‡å‘è¯¥å¯¹è±¡çš„æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œè€Œä¸”ä¸èƒ½æ˜¯`const`å¼•ç”¨ï¼Œå› ä¸ºè¯»å†™ä¸€ä¸ªIOå¯¹è±¡ä¼šæ”¹å˜å…¶çŠ¶æ€ã€‚

#### ğŸ–Œ 1.2ã€IOæ¡ä»¶çŠ¶æ€

æœ‰5ä¸ªçŠ¶æ€æ ‡å¿—ä½ï¼š

1. `ios_base::iostate` ï¼šä¸€ç§æœºå™¨ç›¸å…³çš„ç±»å‹ï¼Œæä¾›è¡¨è¾¾æ¡ä»¶çŠ¶æ€çš„å®Œæ•´åŠŸèƒ½ã€‚
2. `ios_base::badbit` ï¼šç”¨æ¥æ ‡è¯†æµå·²ç»å´©æºƒï¼Œæ— æ³•æŒ½å›ã€‚
3. `ios_base::failbit`ï¼šç”¨æ¥æ ‡è¯†ä¸€ä¸ªIOæ“ä½œå¤±è´¥äº†ã€‚
4. `ios_base::eofbit`ï¼šç”¨æ¥æŒ‡å‡ºæµåˆ°è¾¾äº†æ–‡ä»¶ç»“æŸ
5. `ios_base::goodbit`ï¼šç”¨æ¥æŒ‡å‡ºæµæœªå¤„äºé”™è¯¯çŠ¶æ€ï¼Œæ­¤å€¼ä¿è¯ä¸º0ã€‚

æŸ¥è¯¢æµçŠ¶æ€çš„æ¥å£ï¼š

1. `s.eof()` ï¼šè‹¥æµ s çš„`eofbit`ç½®ä½ï¼Œè¿”å›`true`
2. `s.fail()` ï¼šè‹¥æµ s çš„`failbit`æˆ–`badbit`ç½®ä½ï¼Œè¿”å›`true`
3. `s.bad()` ï¼šè‹¥æµ s çš„`badbit`ç½®ä½ï¼Œè¿”å›`true`
4. `s.good()` ï¼šè‹¥æµså¤„äºæœ‰æ•ˆçŠ¶æ€ï¼Œè¿”å›`true`
5. `s.clear()` ï¼šå°†æµ s ä¸­æ‰€æœ‰çš„æ¡ä»¶çŠ¶æ€ä½å¤ä½ï¼Œå°†æµçš„çŠ¶æ€è®¾ç½®ä¸ºæœ‰æ•ˆï¼Œè¿”å›`void`
6. `s.clear(flags)` ï¼šæ ¹æ®ç»™å®šçš„`flags`æ ‡å¿—ä½ï¼Œå°†æµ s çš„å¯¹åº”æ¡ä»¶çŠ¶æ€ä½å¤ä½ï¼Œ`flags`çš„ç±»å‹ä¸º`strm::iostate`ï¼Œè¿”å›`void`
7. `s.setstate(flags)` ï¼šæ ¹æ®ç»™å®šçš„`flags`æ ‡å¿—ä½ï¼Œå°†æµ s ä¸­å¯¹åº”çš„æ¡ä»¶çŠ¶æ€ä½ç½®ä½ï¼Œ`flags`ç±»å‹ä½`strm::iostate` è¿”å›`void`
8. `s.rdstate()` è¿”å›æµ s å½“å‰çš„æ¡ä»¶çŠ¶æ€ï¼Œè¿”å›å€¼ç±»å‹ä¸º `strm::iostate`

### ğŸ–‹ 2ã€è¾“å…¥

> ä»é”®ç›˜è¾“å…¥å­—ç¬¦ä¸²çš„æ—¶å€™éœ€è¦æ•²ä¸€ä¸‹å›è½¦é”®æ‰èƒ½å¤Ÿå°†è¿™ä¸ªå­—ç¬¦ä¸²é€å…¥åˆ°ç¼“å†²åŒºä¸­ï¼Œé‚£ä¹ˆæ•²å…¥çš„è¿™ä¸ªå›è½¦é”®\(`\r`\)ä¼šè¢«è½¬æ¢ä¸ºä¸€ä¸ªæ¢è¡Œç¬¦`\n`ï¼Œè¿™ä¸ªæ¢è¡Œç¬¦`\n`ä¹Ÿä¼šè¢«å­˜å‚¨åœ¨`cin`çš„ç¼“å†²åŒºä¸­å¹¶ä¸”è¢«å½“æˆä¸€ä¸ªå­—ç¬¦æ¥è®¡ç®—ã€‚`cin`è¯»å–æ•°æ®æ˜¯ä»è¾“å…¥ç¼“å†²åŒºä¸­è·å–æ•°æ®ï¼Œç¼“å†²åŒºä¸ºç©ºæ—¶ï¼Œ`cin`çš„æˆå‘˜å‡½æ•°ä¼šé˜»å¡ç­‰å¾…æ•°æ®çš„åˆ°æ¥ï¼Œä¸€æ—¦ç¼“å†²åŒºä¸­æœ‰æ•°æ®ï¼Œå°±è§¦å‘`cin`çš„æˆå‘˜å‡½æ•°å»è¯»å–æ•°æ®ã€‚

**ä½¿ç”¨`cin`è¿›è¡Œè¯»å–è¾“å…¥ï¼Œå¸¸ç”¨çš„è¯»å–æ–¹æ³•æœ‰:**

* `operator >>`ï¼šç”¨äºè¯»å–æ»¡è¶³å‚æ•°çš„ç±»å‹\(åŸºæœ¬æ•°æ®ç±»å‹éƒ½å¯ä»¥\)ï¼Œè¯»å–æ—¶å°†å¿½ç•¥ç©ºç™½ç¬¦å·ï¼›

å½“`cin>>`ä»ç¼“å†²åŒºä¸­è¯»å–æ•°æ®æ—¶ï¼Œè‹¥ç¼“å†²åŒºä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ç©ºæ ¼ã€`tab`æˆ–æ¢è¡Œè¿™äº›åˆ†éš”ç¬¦æ—¶ï¼Œ`cin>>`ä¼šå°†å…¶å¿½ç•¥å¹¶æ¸…é™¤ï¼Œç»§ç»­è¯»å–ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼Œè‹¥ç¼“å†²åŒºä¸ºç©ºï¼Œåˆ™ç»§ç»­ç­‰å¾…ã€‚ä½†æ˜¯å¦‚æœè¯»å–æˆåŠŸï¼Œå­—ç¬¦åé¢çš„åˆ†éš”ç¬¦æ˜¯æ®‹ç•™åœ¨ç¼“å†²åŒºçš„ï¼Œ`cin>>`ä¸åšå¤„ç†ã€‚ä¸æƒ³ç•¥è¿‡ç©ºç™½å­—ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨ `noskipws` æµæ§åˆ¶ã€‚æ¯”å¦‚`cin >> noskipws >> input`ã€‚

* `int get()`ï¼šè¯»å–å•ä¸ªå­—ç¬¦ï¼Œè¯»å–åˆ°æ–‡ä»¶å°¾æ—¶ï¼Œè¿”å›`EOF`ï¼›
* `istream& get(char& c)`ï¼šè¯»å–å•ä¸ªå­—ç¬¦åˆ°cï¼Œè¯»å–åˆ°æ–‡ä»¶å°¾æ—¶ï¼Œè¿”å›falseï¼›
* `istream& get(char s, streamsize n)`ï¼šç”¨äºè¯»å–Cé£æ ¼å­—ç¬¦ä¸²ï¼Œå®ƒä¸ä¼šä¸¢å¼ƒæ¢è¡Œç¬¦ï¼Œæ¢è¡Œç¬¦å°†ç»§ç»­ç•™åœ¨è¾“å…¥ç¼“å†²åŒºä¸­ï¼Œå› æ­¤æ¥ä¸‹æ¥çš„è¾“å…¥æ“ä½œé¦–å…ˆå°†è¯»å–æ¢è¡Œç¬¦ï¼›
* `istream& get(char* s, streamsize n, char delim)`ï¼šåŒä¸Šï¼Œä½†å¯æŒ‡å®šç»“æŸç¬¦ï¼›
* `istream& get(streambuf& sb)`ï¼›
* `istream& get(streambuf& sb, char delim)`ï¼›

> å…¶ä¸­`streamsize` åœ¨`VC++`ä¸­è¢«å®šä¹‰ä¸ºlong longå‹ã€‚

* `istream& getline(char s, streamsize n)`ï¼šç”¨äºè¯»å–Cé£æ ¼å­—ç¬¦ä¸²ï¼Œé€šè¿‡æ¢è¡Œç¬¦æ¥ç¡®å®šè¡Œå°¾ï¼Œä½†ä¸ä¿å­˜æ¢è¡Œç¬¦ï¼Œè€Œæ˜¯å°†æ¢è¡Œç¬¦ç”¨ç©ºå­—ç¬¦æ¥æ›¿æ¢ï¼›
* `istream& getline(char* s, streamsize count, char delim)`ï¼›

`cin.getline`ä¸`cin.get`çš„åŒºåˆ«æ˜¯ï¼Œ`cin.getline`ä¸ä¼šå°†ç»“æŸç¬¦æˆ–è€…æ¢è¡Œç¬¦æ®‹ç•™åœ¨è¾“å…¥ç¼“å†²åŒºä¸­ã€‚

#### ğŸ–Œ 2.1ã€è¾“å…¥é”™è¯¯æ—¶çš„å¤„ç†

`ios_base`ä¸­åŒ…å«ä¸€ä¸ªç”¨æ¥æè¿°æµçŠ¶æ€çš„æ•°æ®æˆå‘˜ï¼Œç”±3ä¸ªæ ‡è®°ä½ç»„æˆï¼š

* `ios_base::eofbit`ï¼šå½“`cin`æ“ä½œåˆ°è¾¾æ–‡ä»¶æœ«å°¾æ—¶ï¼Œè®¾ç½®æ­¤æ ‡è®°ä½ï¼›
* `ios_base::failbit`ï¼šå½“`cin`æœªèƒ½è¯»å–åˆ°é¢„æœŸå­—ç¬¦æ—¶ï¼Œè®¾ç½®æ­¤æ ‡è®°ä½ï¼›
* `ios_base::badbit`ï¼šå½“å­˜åœ¨æ— æ³•è¯Šæ–­çš„å¤±è´¥ç ´åæµæ—¶ï¼Œè®¾ç½®æ­¤æ ‡è®°ä½ã€‚

ä»¥ä¸Šä»»ä½•ä¸€ä¸ªå¦‚æœè¢«è®¾ç½®ï¼Œé‚£ä¹ˆæµå°†å¯¹åé¢çš„è¾“å…¥/è¾“å‡ºå…³é—­ï¼Œç›´åˆ°ä½è¢«æ¸…é™¤ã€‚`clear()`æ–¹æ³•è´Ÿè´£é‡ç½®æ ‡è®°ä½ã€‚ 

```cpp
int score;
for (int i=0;i < 10;i++) {
    std::cout << "please enter your score: ";
    while(!(std::cin >> score)){
        std::cin.clear(); //clear state bit
        while(std::cin.get() != '\n') { // æ¸…ç©ºè¾“å…¥é˜Ÿåˆ—ä¸­çš„é”™è¯¯å­—ç¬¦
            continue;
        }
        std::cout << "please enter a number: ";
        continue;
    }
    std::cout << "your score: " << score << std::endl;
}
// å½“è¾“å…¥æ•°æ®ä¸èƒ½è½¬æ¢ä¸ºintæ—¶è¯»æ“ä½œå°±ä¼šå¤±è´¥ï¼Œcinçš„failbitå°±ä¼šç½®ä½ã€‚
// 6-8è¡Œï¼Œå¦‚æœä¸æ¸…ç©ºé”™è¯¯å­—ç¬¦ï¼Œ4è¡Œçš„whileä¼šä¸€ç›´è¿›å…¥ã€‚
```

#### ğŸ–Œ 2.2ã€æ¸…ç©ºè¾“å…¥ç¼“å†²åŒº

#### ğŸ–Œ 2.3ã€å…¶ä»–è¾“å…¥çš„æ–¹å¼

**1ã€`getline`è¯»å–ä¸€è¡Œ**

C++ä¸­å®šä¹‰äº†ä¸€ä¸ªåœ¨stdåå­—ç©ºé—´çš„å…¨å±€å‡½æ•°`getline()`ï¼Œå› ä¸ºè¿™ä¸ªå‡½æ•°çš„å‚æ•°ä½¿ç”¨äº†`string`å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å£°æ˜åœ¨äº†`<string>`å¤´æ–‡ä»¶ä¸­ã€‚`getline()`åˆ©ç”¨`cin`å¯ä»¥ä»æ ‡å‡†è¾“å…¥è®¾å¤‡é”®ç›˜è¯»å–ä¸€è¡Œï¼Œå½“é‡åˆ°å¦‚ä¸‹ä¸‰ç§æƒ…å†µä¼šç»“æŸè¯»æ“ä½œï¼š1ï¼‰åˆ°æ–‡ä»¶ç»“æŸï¼›2ï¼‰é‡åˆ°å‡½æ•°çš„å®šç•Œç¬¦ï¼›3ï¼‰è¾“å…¥è¾¾åˆ°æœ€å¤§é™åº¦ã€‚

å‡½æ•°åŸå‹æœ‰ä¸¤ä¸ªé‡è½½å½¢å¼ï¼š

```cpp
istream& getline(istream& is, string& str);  //é»˜è®¤ä»¥æ¢è¡Œç¬¦ç»“æŸ
istream& getline(istream& is, string& str, char delim);
```

### ğŸ–‹ 3ã€è¾“å‡º





## âœ æ–‡ä»¶IO

## âœ å­—ç¬¦ä¸²IO





